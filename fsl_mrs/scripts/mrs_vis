#!/usr/bin/env python

# mrs_vis - quick MRS visualisation
#
# Author: Saad Jbabdi <saad@fmrib.ox.ac.uk>
#
# Copyright (C) 2019 University of Oxford 
# SHBASECOPYRIGHT

import sys

def main():
    nargs = len(sys.argv) - 1
    if nargs < 3:
        print('\nUsage : mrs_vis <FIDfile> <centralFrequency (Hz)> <dwellTime (sec)> [True/False]\n')
        exit()

    FIDfile = sys.argv[1]
    cf      = float(sys.argv[2])
    dt      = float(sys.argv[3])
    conj    = False
    if nargs==4:
        if sys.argv[4] == 'True':
            conj = True

    from fsl_mrs.utils.plotting import plot_spectrum
    from fsl_mrs.utils.mrs_io import read_FID
    import matplotlib.pyplot as plt

    FID,_     = read_FID(FIDfile)
    if len(FID.shape) > 1:
        FID = FID.flatten()
    if conj:
        from numpy import conjugate as conj
        FID = conj(FID)

    plt.figure(figsize=(8,8))
    fig     = plot_spectrum(FID,1/dt,cf,ppmlim=(.2,4.2))
    plt.show()
    

if __name__ == '__main__':
    main()
